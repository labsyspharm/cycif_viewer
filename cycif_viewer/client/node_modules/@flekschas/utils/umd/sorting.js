// @flekschas/utils v0.25.0 Copyright 2020 Fritz Lekschas
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
  typeof define === 'function' && define.amd ? define(['exports'], factory) :
  (global = global || self, factory(global.utils = global.utils || {}));
}(this, (function (exports) { 'use strict';

  function _slicedToArray(arr, i) {
    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
  }

  function _arrayWithHoles(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _iterableToArrayLimit(arr, i) {
    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
      return;
    }

    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  }

  /**
   * Identity function
   * @param   {*}  x  Any kind of value
   * @return  {*}  `x`
   */
  var identity = function identity(x) {
    return x;
  };

  var sortAsc = function sortAsc(a, b) {
    return a - b;
  };
  var sortDesc = function sortDesc(a, b) {
    return b - a;
  };
  /**
   * Return a list of indices sorted by the array
   *
   * @example
   *   X = [9, 5, 11, -1, 0]
   *   sortedIdx = argSort(X)
   *   >> [3, 4, 1, 0, 2]
   *   I.e., the smallest element is X[sortedIdx[0]] == -1
   *
   * @param {array} array - Array of numerical values
   * @param {function} comparator - Pairwise value comparator function
   * @return {array} Array of indices sorted by the values
   */

  var argSort = function argSort(array) {
    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        _ref$getter = _ref.getter,
        getter = _ref$getter === void 0 ? identity : _ref$getter,
        _ref$comparator = _ref.comparator,
        comparator = _ref$comparator === void 0 ? sortAsc : _ref$comparator,
        _ref$ignoreNull = _ref.ignoreNull,
        ignoreNull = _ref$ignoreNull === void 0 ? false : _ref$ignoreNull;

    return array.map(ignoreNull ? function (x, i) {
      return getter(x) === null ? undefined : [getter(x), i];
    } : function (x, i) {
      return [getter(x), i];
    }).sort(function (a, b) {
      return comparator(a[0], b[0]);
    }).reduce(function (out, tuple) {
      if (!tuple) return out;
      out.push(tuple[1]);
      return out;
    }, []);
  };
  /**
   * Return the sort position of each element in an array or object
   *
   * @example
   *   let array = [9, 5, 11, -1, 0];
   *   let pos = sortPos(array)
   *   >> [3, 2, 4, 0, 1]
   *
   *   let object = { 1: 9, 2: 5, 11: 11, 100: -1, 999: 0 };
   *   let pos = sortPos(object)
   *   >> {1: 9, 2: 5, 11: 11, 100: -1, 999: 0}
   *
   *   I.e., the first element of X is at position idxPos[0] == 3
   *
   * @param {array} array - Array of numerical values
   * @param {function} comparator - Pairwise value comparator function
   * @return {array} Array of the sorted value positions
   */

  var sortPos = function sortPos(source) {
    var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        _ref2$getter = _ref2.getter,
        getter = _ref2$getter === void 0 ? identity : _ref2$getter,
        _ref2$comparator = _ref2.comparator,
        comparator = _ref2$comparator === void 0 ? sortAsc : _ref2$comparator,
        _ref2$ignoreNull = _ref2.ignoreNull,
        ignoreNull = _ref2$ignoreNull === void 0 ? false : _ref2$ignoreNull;

    return Object.entries(source).map(ignoreNull ? function (_ref3) {
      var _ref4 = _slicedToArray(_ref3, 2),
          id = _ref4[0],
          x = _ref4[1];

      return getter(x) === null ? undefined : [id, getter(x)];
    } : function (_ref5) {
      var _ref6 = _slicedToArray(_ref5, 2),
          id = _ref6[0],
          x = _ref6[1];

      return [id, getter(x)];
    }).sort(function (a, b) {
      return comparator(a[1], b[1]);
    }).reduce(function (out, tuple, i) {
      if (!tuple) return out;
      out[tuple[0]] = i;
      return out;
    }, new source.constructor());
  };

  exports.argSort = argSort;
  exports.sortAsc = sortAsc;
  exports.sortDesc = sortDesc;
  exports.sortPos = sortPos;

  Object.defineProperty(exports, '__esModule', { value: true });

})));
